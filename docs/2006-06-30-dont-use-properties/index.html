<!DOCTYPE html>
<html lang="en">
<head>
<!-- Last built: 2019-09-20T15:30:45-07:00 -->
<meta charset="utf-8" />
<meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
<meta http-equiv="Pragma" content="no-cache">
<meta http-equiv="Expires" content="0">
<title>Andy McKay :: Don't use properties</title>
<link href="/css/style.css?v=2019-09-20T15:30:45-07:00" rel="stylesheet" type="text/css">
<link href="/css/pygments.css?v=2019-09-20T15:30:45-07:00" rel="stylesheet" type="text/css">
<link rel="shortcut icon" type="image/ico" href="/images/favicon.ico" />
<link rel="alternate" href="/atom.xml" type="application/atom+xml">
<meta name="viewport" content="initial-scale=1, maximum-scale=1">
</head>
<body>
<div id="main">
<header>
  <h1><a href="/">Andy McKay</a></h1>
</header>
<section>
<article>
<div class="meta">Jun 30, 2006</div>
<h2><a href="/2006-06-30-dont-use-properties/">Don't use properties</a></h2>
<hr class="florished">
<p>Was helping a person on irc the other day. The problem was they were including a string into a template. The string was coming from a property on an object, that property was being acquired through acquisition. The code was something like this:</p>

<p><textarea name="code" class="xml">tal:content=&quot;context/getSectionText&quot;</textarea></p>

<p>So the what&#39;s the problem here?</p>

<ul>
    <li>What's the chance you will remember in 6 months what getSectionText is? Go away for a day then try to remember (ok, perhaps I'm just getting old). But you'll never remember that is a property on an object and there is no easy way of finding that out.</li>
    <li>There is no easy way to change it.</li>
    <li>There is no easy way to list them all - short of waking up every object and examining it.</li>
    <li>You could conceivably get hit by security when someone workflows the object with the property for you (admittedly perhaps less of a concern).</li>
</ul>

<p>In this case I prefer a Python script that searches the objects location and returns a value. Here&#39;s an example that I pulled from Enfold Systems that displays a different image on the top of every folder.
<pre>
<textarea name="code" class="python"></p>

<h1>add in new images here</h1>

<p>images = {
  &quot;desktop&quot;:&quot;enfoldsystems/sections/desktop.jpg&quot;,
  &quot;server&quot;:&quot;enfoldsystems/sections/server.jpg&quot;,
}
url = context.portal_url.getRelativeContentPath(context)
img = None</p>

<h1>in this case we are looking for url&#39;s like</h1>

<h1>products/server or products/proxy</h1>

<p>if len(url) &gt; 1:
  # look up the images
  if url[0].lower()==&quot;products&quot;:
    product = url[1].lower()
    img = products.get(product, None)</p>

<h1>set the default</h1>

<p>if img is None:
  img = &quot;sections/homepage.jpg&quot;
return img
</textarea>
</pre></p>

<p>Next we add this into the skin. In this case this is called getSectionImage and the template reads:</p>

<p><textarea name="code" class="xml">tal:attributes=&quot;src string:$portal_url/${context/getSectionImage}&quot;</textarea></p>

<p>Not the worlds most sophisticated peice of code but...
<ul>
    <li>It&#39;s easy to remember, when looking in our templates and I spot the line getSectionImage, its easy for me to look in the skin and remember there is a script called getSectionImage even now two years later.</li></p>
<div class="highlight"><pre><code class="language-" data-lang="">&lt;li&gt;I can easily see what all the images are and alter them.&lt;/li&gt;
&lt;li&gt;Never any security to worry about.&lt;/li&gt;
</code></pre></div>
<p></ul>
The only real problem you have is that for complicated requirements, that script can get complicated, but that&#39;s true of properties too.</p>

<div id="navigation">
  <a href="/2006-06-28-tiddlywiki-rocks/">&laquo; older</a>
  <a href="/2006-06-30-startups-in-vancouver/">newer &raquo;</a>
</div>

</article>
</section>
<footer>
<div id="thefooter">
  <p>
    <a href="/">Home</a> &bull;
    <a href="/archives/">Archives</a>
  </p>
  <p>
    I work at <a href="https://github.com">GitHub</a>. I used to be at <a href="https://www.mozilla.com">Mozilla</a>.<br />
    <a href="mailto:andy@agmweb.ca">andy@agmweb.ca</a> &bull;
    <a href="https://mckay.pub.ca/atom.xml">RSS</a><br />
    <a href="http://twitter.com/andymckay">Twitter</a> &bull;
    <a href="http://www.linkedin.com/pub/andy-mckay/11/225/aa1">Linkedin</a> &bull;
    <a href="http://github.com/andymckay">GitHub</a><br />
  </p>
</div>
</footer>
</div>
<script src="https://www.google-analytics.com/urchin.js" type="text/javascript">
</script>
<script type="text/javascript">
_uacct = "UA-1636311-1";
urchinTracker();
</script>
</body>
</html>
